<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started • bridge</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="bridge">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bridge</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/bridge.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/frbcesab/bridge/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="bridge_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/frbcesab/bridge/blob/HEAD/vignettes/bridge.Rmd" class="external-link"><code>vignettes/bridge.Rmd</code></a></small>
      <div class="hidden name"><code>bridge.Rmd</code></div>

    </div>

    
    
<p>The aim of the package <code>bridge</code> is to provide tools to work with directed (asymetric) spatial networks. It allows users to easily create and visualize network objects, like <strong>nodes list</strong>, <strong>edges lists</strong>, <strong>connectivity matrix</strong>, <strong>nodes by edges matrix</strong>, and <strong>edges weights vector</strong>. These objects can be used later in Asymetric Eigenvector Maps (AEM, Blanchet <em>et al.</em> 2008) available in the package <a href="https://cran.r-project.org/package=adespatial" class="external-link"><code>adespatial</code></a> (Dray <em>et al.</em> 2022).</p>
<p>This package has been developed for the <a href="https://www.fondationbiodiversite.fr/en/about-the-foundation/le-cesab/" class="external-link">FRB-CESAB</a> working group <a href="https://www.fondationbiodiversite.fr/en/the-frb-in-action/programs-and-projects/le-cesab/bridge/" class="external-link">Bridge</a> that aims to better understand the role of local and regional environmental factors in shaping the taxonomic and functional diversity of plant communities established along river corridors, roadside corridors and cultivated field margins.</p>
<p><br></p>
<p>The package <code>bridge</code> also provides some tools to work with Moran’s Eigenvector Maps (MEM, Dray <em>et al.</em> 2006) but this vignette shows only its usage with <strong>directed spatial network</strong>.</p>
<p><br></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/frbcesab/bridge" class="external-link">"bridge"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p>First let’s define a custom theme for the <code>ggplot2</code> visualizations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">custom_theme</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, family <span class="op">=</span> <span class="st">"serif"</span>, size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>,</span>
<span>        plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span>, family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span>,</span>
<span>        axis.title   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text    <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><br></p>
<div class="section level2">
<h2 id="provided-data">Provided data<a class="anchor" aria-label="anchor" href="#provided-data"></a>
</h2>
<p>The package <code>bridge</code> comes with two datasets:</p>
<ul>
<li>
<strong>Adour river</strong>, an <code>sf</code> spatial object of type <code>LINESTRING</code> providing the geometry of the French river <em>L’Adour</em>;</li>
<li>
<strong>Adour sites</strong>, a <code>data.frame</code> with sites labels and sites coordinates along the river.</li>
</ul>
<p><br></p>
<div class="section level3">
<h3 id="adour-river">Adour river<a class="anchor" aria-label="anchor" href="#adour-river"></a>
</h3>
<p>Let’s import the <strong>Adour river</strong> spatial layer.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import the spatial layer of Adour river ----</span></span>
<span><span class="va">path_to_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"adour_lambert93.gpkg"</span>, package <span class="op">=</span> <span class="st">"bridge"</span><span class="op">)</span></span>
<span><span class="va">adour_river</span>  <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">path_to_file</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">adour_river</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: LINESTRING</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 334324.8 ymin: 6207072 xmax: 480886.8 ymax: 6308530</span></span>
<span><span class="co">#&gt; Projected CRS: RGF93 / Lambert-93</span></span>
<span><span class="co">#&gt;   river_name                           geom</span></span>
<span><span class="co">#&gt; 1    L'Adour LINESTRING (480886.8 620722...</span></span></code></pre></div>
<p>This layer is an <a href="https://cran.r-project.org/package=sf" class="external-link"><code>sf</code></a> spatial object of type <code>LINESTRING</code> and contains one single row (geometry) defined in the <a href="https://epsg.io/2154" class="external-link">RGF93 / Lambert-93</a> projection.</p>
<p><br></p>
<p>Now let’s import a base map of France to locate the Adour river using the package <a href="https://cran.r-project.org/package=rnaturalearth" class="external-link"><code>rnaturalearth</code></a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import France departments ----</span></span>
<span><span class="va">france</span> <span class="op">&lt;-</span> <span class="fu">rnaturalearth</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_states.html" class="external-link">ne_states</a></span><span class="op">(</span><span class="st">"france"</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove overseas territories ----</span></span>
<span><span class="va">france</span> <span class="op">&lt;-</span> <span class="va">france</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^FR\\."</span>, <span class="va">france</span><span class="op">$</span><span class="st">"code_hasc"</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Project layer to RGF93 / Lambert-93 system ----</span></span>
<span><span class="va">france</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">france</span>, <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">adour_river</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p>Let’s locate the Adour river of the France map.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get extent of Adour river ----</span></span>
<span><span class="va">adour_extent</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">adour_river</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add some margin around ----</span></span>
<span><span class="va">adour_extent</span> <span class="op">&lt;-</span> <span class="va">adour_extent</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10000</span>, <span class="op">-</span><span class="fl">10000</span>, <span class="fl">10000</span>, <span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">france</span>, fill <span class="op">=</span> <span class="st">"lightgray"</span>, col <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">adour_river</span>, col <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="va">adour_extent</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title   <span class="op">=</span> <span class="st">"The French river Adour"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"RGF93 / Lambert-93 Projection"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">custom_theme</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="bridge_files/figure-html/map-adour-river-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="adour-sites">Adour sites<a class="anchor" aria-label="anchor" href="#adour-sites"></a>
</h3>
<p>Let’s import the <strong>Adour sites</strong> data representing fictitious survey sites around the Adour.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Import the dataset of sites ----</span></span>
<span><span class="va">path_to_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"adour_sites_coords.csv"</span>, package <span class="op">=</span> <span class="st">"bridge"</span><span class="op">)</span></span>
<span><span class="va">adour_sites</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">path_to_file</span><span class="op">)</span></span>
<span><span class="va">adour_sites</span></span>
<span><span class="co">#&gt;    site longitude latitude</span></span>
<span><span class="co">#&gt; 1  S-01  470911.2  6219515</span></span>
<span><span class="co">#&gt; 2  S-02  466841.1  6231099</span></span>
<span><span class="co">#&gt; 3  S-03  464962.6  6242684</span></span>
<span><span class="co">#&gt; 4  S-04  466215.0  6252389</span></span>
<span><span class="co">#&gt; 5  S-05  464023.4  6266791</span></span>
<span><span class="co">#&gt; 6  S-06  458701.0  6284011</span></span>
<span><span class="co">#&gt; 7  S-07  445238.4  6291838</span></span>
<span><span class="co">#&gt; 8  S-08  434593.6  6302169</span></span>
<span><span class="co">#&gt; 9  S-09  418626.3  6306239</span></span>
<span><span class="co">#&gt; 10 S-10  379177.9  6304048</span></span></code></pre></div>
<p>This <code>data.frame</code> contains three columns: the site label and sites coordinates, also defined in the <a href="https://epsg.io/2154" class="external-link">RGF93 / Lambert-93</a> projection.</p>
<p><br></p>
<p>Let’s convert this <code>data.frame</code> into an <code>sf</code> object of type <code>POINT</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert data.frame to sf object ----</span></span>
<span><span class="va">adour_sites_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">adour_sites</span>, coords <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, crs <span class="op">=</span> <span class="st">"epsg:2154"</span><span class="op">)</span></span>
<span><span class="va">adour_sites_sf</span></span>
<span><span class="co">#&gt; Simple feature collection with 10 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 379177.9 ymin: 6219515 xmax: 470911.2 ymax: 6306239</span></span>
<span><span class="co">#&gt; Projected CRS: RGF93 / Lambert-93</span></span>
<span><span class="co">#&gt;    site                 geometry</span></span>
<span><span class="co">#&gt; 1  S-01 POINT (470911.2 6219515)</span></span>
<span><span class="co">#&gt; 2  S-02 POINT (466841.1 6231099)</span></span>
<span><span class="co">#&gt; 3  S-03 POINT (464962.6 6242684)</span></span>
<span><span class="co">#&gt; 4  S-04   POINT (466215 6252389)</span></span>
<span><span class="co">#&gt; 5  S-05 POINT (464023.4 6266791)</span></span>
<span><span class="co">#&gt; 6  S-06   POINT (458701 6284011)</span></span>
<span><span class="co">#&gt; 7  S-07 POINT (445238.4 6291838)</span></span>
<span><span class="co">#&gt; 8  S-08 POINT (434593.6 6302169)</span></span>
<span><span class="co">#&gt; 9  S-09 POINT (418626.3 6306239)</span></span>
<span><span class="co">#&gt; 10 S-10 POINT (379177.9 6304048)</span></span></code></pre></div>
<p><strong>Note:</strong> The package <code>bridge</code> expects that each site is one row in this object and its geometry is <code>POINT</code> (other geometry like <code>MUTLIPOINT</code>, <code>POLYGON</code>, etc.) are not implemented.</p>
<p><br></p>
<p>Finally, let’s map these sites and the Adour river.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">adour_river</span>, col <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">adour_sites_sf</span>, shape <span class="op">=</span> <span class="fl">19</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">adour_sites</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">longitude</span>, y <span class="op">=</span> <span class="va">latitude</span>, label <span class="op">=</span> <span class="va">site</span><span class="op">)</span>, </span>
<span>            size <span class="op">=</span> <span class="fl">4.2</span>, nudge_x <span class="op">=</span> <span class="fl">5000</span>, family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title   <span class="op">=</span> <span class="st">"Study area (French river Adour)"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"RGF93 / Lambert-93 Projection"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">custom_theme</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">454180</span>, xend <span class="op">=</span> <span class="fl">440170</span>, y <span class="op">=</span> <span class="fl">6216290</span>, yend <span class="op">=</span> <span class="fl">6263320</span><span class="op">)</span>, </span>
<span>               arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="st">'cm'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'closed'</span><span class="op">)</span>,</span>
<span>               size  <span class="op">=</span> <span class="fl">2.25</span><span class="op">)</span></span></code></pre></div>
<p><img src="bridge_files/figure-html/map-adour-sites-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The arrow indicates the direction of the Adour river flow. This means that our system is a directed spatial network where the main direction is from upstream to downstream.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="nodes-list">Nodes list<a class="anchor" aria-label="anchor" href="#nodes-list"></a>
</h2>
<p>Let’s identify the <strong>nodes list</strong>, i.e. a vector of unique <strong>ordered</strong> sites labels.</p>
<p><br></p>
<p><strong>Important:</strong> as the sites have a direction (along the Adour river, from upstream to downstream), the order of the sites must be found in the sites labels.</p>
<p>For instance, in the Adour sites dataset, sites are labelled as <strong>S-01</strong>, <strong>S-02</strong>, …, <strong>S-10</strong>. This means that the most upstream site is <strong>S-01</strong> and the most downstream is <strong>S-10</strong>.</p>
<p><br></p>
<p>But be aware that ordering characters can have some unwanted effects, especially if they contain numbers.</p>
<p>For instance,</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Alphanumerical ordering ----</span></span>
<span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"s1"</span>,  <span class="st">"s2"</span>, <span class="st">"s11"</span>, <span class="st">"s10"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">sites</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "s1"  "s10" "s11" "s2"</span></span>
<span></span>
<span><span class="co"># Natural ordering ----</span></span>
<span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s01"</span>, <span class="st">"s02"</span>, <span class="st">"s11"</span>, <span class="st">"s10"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">sites</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "s01" "s02" "s10" "s11"</span></span></code></pre></div>
<p>You may want to code your sites as in the second example, i.e. based on a <strong>Natural ordering</strong>.</p>
<p><br></p>
<p>Let’s use the function <code><a href="../reference/nodes_list.html">nodes_list()</a></code> to 1) retrieve the unique labels of sites, and to 2) order them along the Adour river (from upstream to downstream).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adour_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nodes_list.html">nodes_list</a></span><span class="op">(</span><span class="va">adour_sites</span><span class="op">$</span><span class="st">"site"</span><span class="op">)</span></span>
<span><span class="va">adour_nodes</span></span>
<span><span class="co">#&gt;  [1] "S-01" "S-02" "S-03" "S-04" "S-05" "S-06" "S-07" "S-08" "S-09" "S-10"</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="edges-list">Edges list<a class="anchor" aria-label="anchor" href="#edges-list"></a>
</h2>
<p>From this nodes list, we can create an <strong>edges list</strong>, i.e. a table describing links between nodes. Several methods exist to identify spatial neighbors and most of them are available in the package <a href="https://cran.r-project.org/package=spdep" class="external-link"><code>spdep</code></a> (Bivand <em>et al.</em> 2022).</p>
<p><br></p>
<p>Here we implement our own method to detect spatial neighbors based sites labels and a degree of neighborhood. As our sites are ordered along the Adour river, if we use a degree <strong>1</strong> of neighborhood, a site will be linked to the first next site (downstream) and also to the first previous site (upstream). If we use a degree <strong>2</strong> of neighborhood, a site will be linked to the two next sites (downstream) and also to the two previous sites (upstream). And so on.</p>
<p><br></p>
<p>Let’s create this edges list with the function <code><a href="../reference/edges_list.html">edges_list()</a></code> provided by the package <code>bridge</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List of edges with degree 1 of neighborhood ----</span></span>
<span><span class="va">adour_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edges_list.html">edges_list</a></span><span class="op">(</span><span class="va">adour_nodes</span>, degree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">adour_edges</span></span>
<span><span class="co">#&gt;    edge_id edge from   to</span></span>
<span><span class="co">#&gt; 1      E-1    1 S-01 S-02</span></span>
<span><span class="co">#&gt; 2      E-1    1 S-02 S-01</span></span>
<span><span class="co">#&gt; 3      E-2    1 S-02 S-03</span></span>
<span><span class="co">#&gt; 4      E-2    1 S-03 S-02</span></span>
<span><span class="co">#&gt; 5      E-3    1 S-03 S-04</span></span>
<span><span class="co">#&gt; 6      E-3    1 S-04 S-03</span></span>
<span><span class="co">#&gt; 7      E-4    1 S-04 S-05</span></span>
<span><span class="co">#&gt; 8      E-4    1 S-05 S-04</span></span>
<span><span class="co">#&gt; 9      E-5    1 S-05 S-06</span></span>
<span><span class="co">#&gt; 10     E-5    1 S-06 S-05</span></span>
<span><span class="co">#&gt; 11     E-6    1 S-06 S-07</span></span>
<span><span class="co">#&gt; 12     E-6    1 S-07 S-06</span></span>
<span><span class="co">#&gt; 13     E-7    1 S-07 S-08</span></span>
<span><span class="co">#&gt; 14     E-7    1 S-08 S-07</span></span>
<span><span class="co">#&gt; 15     E-8    1 S-08 S-09</span></span>
<span><span class="co">#&gt; 16     E-8    1 S-09 S-08</span></span>
<span><span class="co">#&gt; 17     E-9    1 S-09 S-10</span></span>
<span><span class="co">#&gt; 18     E-9    1 S-10 S-09</span></span></code></pre></div>
<p>This <code>data.frame</code> contains four columns:</p>
<ul>
<li>
<code>edge_id</code>: label of the edge</li>
<li>
<code>edge</code>: 0 (no edge) or 1 (edge), useful if <code>all = TRUE</code> (see below)</li>
<li>
<code>from</code>: label of the most upstream node of the edge</li>
<li>
<code>to</code>: label of the most downstream node of the edge</li>
</ul>
<p><br></p>
<p>The function <code><a href="../reference/edges_list.html">edges_list()</a></code> has three additional arguments:</p>
<ul>
<li>
<code>self</code>: if <code>TRUE</code>, a node can be linked to itself. Default is <code>FALSE</code>.</li>
<li>
<code>all</code>: if <code>TRUE</code>, the missing edges are also returned. Default is <code>FALSE</code>.</li>
<li>
<code>directed</code>: if <code>FALSE</code> (default), symmetrical edges (e.g. <code>S01-S02</code> and <code>S02-S01</code>) are returned (<em>undirected network</em>). Otherwise (<em>directed network</em>) only the first edge (e.g. <code>S01-S02</code>) is returned (according to the direction of the network).</li>
</ul>
<p><br></p>
<p><strong>Tips: </strong> if you want to use Moran’s Eigenvector Maps (MEM) use <code>directed = FALSE</code>. If you want to use Asymetric Eigenvector Maps (AEM) use <code>directed = TRUE</code>.</p>
<p><br></p>
<p>Let’s use this function <code><a href="../reference/edges_list.html">edges_list()</a></code> in a directed way.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List of edges with degree 1 of neighborhood (directed network) ----</span></span>
<span><span class="va">adour_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edges_list.html">edges_list</a></span><span class="op">(</span><span class="va">adour_nodes</span>, degree <span class="op">=</span> <span class="fl">1</span>, directed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">adour_edges</span></span>
<span><span class="co">#&gt;   edge_id edge from   to</span></span>
<span><span class="co">#&gt; 1     E-1    1 S-01 S-02</span></span>
<span><span class="co">#&gt; 2     E-2    1 S-02 S-03</span></span>
<span><span class="co">#&gt; 3     E-3    1 S-03 S-04</span></span>
<span><span class="co">#&gt; 4     E-4    1 S-04 S-05</span></span>
<span><span class="co">#&gt; 5     E-5    1 S-05 S-06</span></span>
<span><span class="co">#&gt; 6     E-6    1 S-06 S-07</span></span>
<span><span class="co">#&gt; 7     E-7    1 S-07 S-08</span></span>
<span><span class="co">#&gt; 8     E-8    1 S-08 S-09</span></span>
<span><span class="co">#&gt; 9     E-9    1 S-09 S-10</span></span></code></pre></div>
<p><br></p>
<p>The package <code>bridge</code> provides a convenient function to convert this edges list table to an <code>sf</code> object of type <code>LINESTRING</code>: <code><a href="../reference/edges_to_sf.html">edges_to_sf()</a></code>.</p>
<p><br></p>
<p>Let’s convert the edges list to a spatial object.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert edges list to sf object ----</span></span>
<span><span class="va">adour_edges_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edges_to_sf.html">edges_to_sf</a></span><span class="op">(</span><span class="va">adour_edges</span>, <span class="va">adour_sites_sf</span><span class="op">)</span></span>
<span><span class="va">adour_edges_sf</span></span>
<span><span class="co">#&gt; Simple feature collection with 9 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: LINESTRING</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 466841.1 ymin: 6219515 xmax: 470911.2 ymax: 6231099</span></span>
<span><span class="co">#&gt; Projected CRS: RGF93 / Lambert-93</span></span>
<span><span class="co">#&gt;   edge_id from   to                       geometry</span></span>
<span><span class="co">#&gt; 1     E-1 S-01 S-02 LINESTRING (470911.2 621951...</span></span>
<span><span class="co">#&gt; 2     E-2 S-02 S-03 LINESTRING (466841.1 623109...</span></span>
<span><span class="co">#&gt; 3     E-3 S-03 S-04 LINESTRING (464962.6 624268...</span></span>
<span><span class="co">#&gt; 4     E-4 S-04 S-05 LINESTRING (466215 6252389,...</span></span>
<span><span class="co">#&gt; 5     E-5 S-05 S-06 LINESTRING (464023.4 626679...</span></span>
<span><span class="co">#&gt; 6     E-6 S-06 S-07 LINESTRING (458701 6284011,...</span></span>
<span><span class="co">#&gt; 7     E-7 S-07 S-08 LINESTRING (445238.4 629183...</span></span>
<span><span class="co">#&gt; 8     E-8 S-08 S-09 LINESTRING (434593.6 630216...</span></span>
<span><span class="co">#&gt; 9     E-9 S-09 S-10 LINESTRING (418626.3 630623...</span></span></code></pre></div>
<p><br></p>
<p>Let’s add these edges to our map.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">adour_river</span>, col <span class="op">=</span> <span class="st">"darkgray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">adour_edges_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">adour_sites_sf</span>, shape <span class="op">=</span> <span class="fl">19</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title   <span class="op">=</span> <span class="st">"Edges with degree 1 of neighborhood"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"RGF93 / Lambert-93 Projection"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">custom_theme</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="bridge_files/figure-html/map-adour-edges-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><br></p>
<p>Finally, let’s increase the degree of neighborhood.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List of edges with degree 3 of neighborhood ----</span></span>
<span><span class="va">adour_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edges_list.html">edges_list</a></span><span class="op">(</span><span class="va">adour_nodes</span>, degree <span class="op">=</span> <span class="fl">3</span>, directed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert edges list to sf object ----</span></span>
<span><span class="va">adour_edges_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edges_to_sf.html">edges_to_sf</a></span><span class="op">(</span><span class="va">adour_edges</span>, <span class="va">adour_sites_sf</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">adour_river</span>, col <span class="op">=</span> <span class="st">"darkgray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">adour_edges_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">adour_sites_sf</span>, shape <span class="op">=</span> <span class="fl">19</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title   <span class="op">=</span> <span class="st">"Edges with degree 3 of neighborhood"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"RGF93 / Lambert-93 Projection"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">custom_theme</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="bridge_files/figure-html/map-adour-edges-3-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="connectivity-matrix">Connectivity matrix<a class="anchor" aria-label="anchor" href="#connectivity-matrix"></a>
</h2>
<p>We can convert the edges list to a <strong>connectivity matrix</strong> (also called <em>adjacency matrix</em>) by using the function <code><a href="../reference/adjacency_matrix.html">adjacency_matrix()</a></code>. A connectivity matrix is a matrix of dimensions <code>n x n</code>, where <code>n</code> is the number of nodes indicating the presence of an edge between two nodes (noted as <code>1</code>) or the absence of edge (noted as <code>0</code>).</p>
<p><br></p>
<p><strong>Note:</strong> this object is useless to work with AEM, but can useful to check the edges list.</p>
<p><br></p>
<p>The function <code><a href="../reference/adjacency_matrix.html">adjacency_matrix()</a></code> of the package <code>bridge</code> only requires the edges list as argument.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create list of edges ----</span></span>
<span><span class="va">adour_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edges_list.html">edges_list</a></span><span class="op">(</span><span class="va">adour_nodes</span>, degree <span class="op">=</span> <span class="fl">1</span>, directed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">adour_edges</span></span>
<span><span class="co">#&gt;   edge_id edge from   to</span></span>
<span><span class="co">#&gt; 1     E-1    1 S-01 S-02</span></span>
<span><span class="co">#&gt; 2     E-2    1 S-02 S-03</span></span>
<span><span class="co">#&gt; 3     E-3    1 S-03 S-04</span></span>
<span><span class="co">#&gt; 4     E-4    1 S-04 S-05</span></span>
<span><span class="co">#&gt; 5     E-5    1 S-05 S-06</span></span>
<span><span class="co">#&gt; 6     E-6    1 S-06 S-07</span></span>
<span><span class="co">#&gt; 7     E-7    1 S-07 S-08</span></span>
<span><span class="co">#&gt; 8     E-8    1 S-08 S-09</span></span>
<span><span class="co">#&gt; 9     E-9    1 S-09 S-10</span></span>
<span></span>
<span><span class="co"># Create connectivity matrix ----</span></span>
<span><span class="va">adour_edges_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjacency_matrix.html">adjacency_matrix</a></span><span class="op">(</span><span class="va">adour_edges</span><span class="op">)</span></span>
<span><span class="va">adour_edges_mat</span></span>
<span><span class="co">#&gt;      S-01 S-02 S-03 S-04 S-05 S-06 S-07 S-08 S-09 S-10</span></span>
<span><span class="co">#&gt; S-01    0    1    0    0    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; S-02    0    0    1    0    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; S-03    0    0    0    1    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; S-04    0    0    0    0    1    0    0    0    0    0</span></span>
<span><span class="co">#&gt; S-05    0    0    0    0    0    1    0    0    0    0</span></span>
<span><span class="co">#&gt; S-06    0    0    0    0    0    0    1    0    0    0</span></span>
<span><span class="co">#&gt; S-07    0    0    0    0    0    0    0    1    0    0</span></span>
<span><span class="co">#&gt; S-08    0    0    0    0    0    0    0    0    1    0</span></span>
<span><span class="co">#&gt; S-09    0    0    0    0    0    0    0    0    0    1</span></span>
<span><span class="co">#&gt; S-10    0    0    0    0    0    0    0    0    0    0</span></span></code></pre></div>
<p>See the documentation of the function <code><a href="../reference/adjacency_matrix.html">adjacency_matrix()</a></code> for other usage.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="nodes-by-edges-matrix">Nodes-by-edges matrix<a class="anchor" aria-label="anchor" href="#nodes-by-edges-matrix"></a>
</h2>
<p>The first object required by AEM is the nodes-by-edges matrix, i.e. a matrix of dimensions <code>n x k</code>, where <code>n</code> is the number of nodes (in rows) and <code>k</code> the number of edges (in columns). This matrix represents the presence of a link influencing a site, directly or indirectly. It also gives the direction of the network.</p>
<p><br></p>
<p>The function <code><a href="../reference/nodes_by_edges_matrix.html">nodes_by_edges_matrix()</a></code> of the package <code>bridge</code> is an alternative to the function <a href="https://sdray.github.io/adespatial/reference/aem.build.binary.html" class="external-link"><code>aem.build.binary()</code></a> of the package <a href="https://cran.r-project.org/package=adespatial" class="external-link"><code>adespatial</code></a>. This function creates the same output but works in a different way: it’s only based on nodes labels (not on spatial coordinates). In addition, the function <code><a href="../reference/nodes_by_edges_matrix.html">nodes_by_edges_matrix()</a></code> adds labels to nodes and edges.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create nodes-by-edges matrix ----</span></span>
<span><span class="va">adour_edges_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nodes_by_edges_matrix.html">nodes_by_edges_matrix</a></span><span class="op">(</span><span class="va">adour_edges</span><span class="op">)</span></span>
<span><span class="va">adour_edges_mat</span></span>
<span><span class="co">#&gt; $se.mat</span></span>
<span><span class="co">#&gt;      E-01 E-02 E-03 E-04 E-05 E-06 E-07 E-08 E-09 E-10</span></span>
<span><span class="co">#&gt; S-01    1    0    0    0    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; S-02    1    1    0    0    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; S-03    1    1    1    0    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; S-04    1    1    1    1    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; S-05    1    1    1    1    1    0    0    0    0    0</span></span>
<span><span class="co">#&gt; S-06    1    1    1    1    1    1    0    0    0    0</span></span>
<span><span class="co">#&gt; S-07    1    1    1    1    1    1    1    0    0    0</span></span>
<span><span class="co">#&gt; S-08    1    1    1    1    1    1    1    1    0    0</span></span>
<span><span class="co">#&gt; S-09    1    1    1    1    1    1    1    1    1    0</span></span>
<span><span class="co">#&gt; S-10    1    1    1    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $edges</span></span>
<span><span class="co">#&gt;      from   to</span></span>
<span><span class="co">#&gt; E-01    0 S-01</span></span>
<span><span class="co">#&gt; E-02 S-01 S-02</span></span>
<span><span class="co">#&gt; E-03 S-02 S-03</span></span>
<span><span class="co">#&gt; E-04 S-03 S-04</span></span>
<span><span class="co">#&gt; E-05 S-04 S-05</span></span>
<span><span class="co">#&gt; E-06 S-05 S-06</span></span>
<span><span class="co">#&gt; E-07 S-06 S-07</span></span>
<span><span class="co">#&gt; E-08 S-07 S-08</span></span>
<span><span class="co">#&gt; E-09 S-08 S-09</span></span>
<span><span class="co">#&gt; E-10 S-09 S-10</span></span></code></pre></div>
<p>This function returns a list with the following elements:</p>
<ul>
<li>
<code>se.mat</code>: the nodes-by-edges matrix of dimensions <code>n x k</code>, where <code>n</code> is the number of nodes and <code>k</code> the number of edges (including the edge between the fictitious origin and the first site);</li>
<li>
<code>edges</code>: a <code>data.frame</code> of edges list.</li>
</ul>
<p><br></p>
<p><strong>Note:</strong> a fictitious <code>origin</code> site (coded as <code>0</code>) has been created and represents the first edge (coded as <code>E-01</code>) to the first site.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="edges-weights">Edges weights<a class="anchor" aria-label="anchor" href="#edges-weights"></a>
</h2>
<div class="section level3">
<h3 id="euclidean-distance">Euclidean distance<a class="anchor" aria-label="anchor" href="#euclidean-distance"></a>
</h3>
<p>The Euclidean distance, a straightforward metric to compute distances between pairs of nodes, is implemented in the function <code><a href="../reference/distance_euclidean.html">distance_euclidean()</a></code>. This function only requires the coordinates of sites (object <code>sf</code>) and will compute distances between each <strong>possible</strong> pairs of sites.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Euclidean distance between pairs of sites ----</span></span>
<span><span class="va">adour_dists</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distance_euclidean.html">distance_euclidean</a></span><span class="op">(</span><span class="va">adour_sites_sf</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">adour_dists</span><span class="op">)</span></span>
<span><span class="co">#&gt;   from   to   weight</span></span>
<span><span class="co">#&gt; 1 S-01 S-01     0.00</span></span>
<span><span class="co">#&gt; 2 S-01 S-02 12278.29</span></span>
<span><span class="co">#&gt; 3 S-01 S-03 23919.63</span></span>
<span><span class="co">#&gt; 4 S-01 S-04 33207.48</span></span>
<span><span class="co">#&gt; 5 S-01 S-05 47774.67</span></span>
<span><span class="co">#&gt; 6 S-01 S-06 65640.77</span></span></code></pre></div>
<p>The returned object is a <code>data.frame</code> will the following three columns:</p>
<ul>
<li>
<code>from</code>, the label of the first node</li>
<li>
<code>to</code>, the label of the second node</li>
<li>
<code>weight</code>, the Euclidean distance between two nodes</li>
</ul>
<p><br></p>
<p>Note that if the units of the coordinates system are in degrees (geodetic coordinates), the Great Circle distance will be used instead. See the documentation of the function <code><a href="../reference/distance_euclidean.html">distance_euclidean()</a></code> for further detail.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="distance-along-river">Distance along river<a class="anchor" aria-label="anchor" href="#distance-along-river"></a>
</h3>
<p>The function <code><a href="../reference/distance_along.html">distance_along()</a></code> implements a more complex way to compute distances between pairs of sites by taking into account the shape of the river. The distance between two sites will be equal to the length of river segment between these two sites.</p>
<p>To create segments, this function will sample points on the river and select the two points of the river that are the nearest from the two sites. These two points will define the endpoints of the segment.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Distance along the river between pairs of sites ----</span></span>
<span><span class="fu"><a href="../reference/distance_along.html">distance_along</a></span><span class="op">(</span><span class="va">adour_sites_sf</span>, <span class="va">adour_river</span>, density <span class="op">=</span> <span class="fl">0.01</span>, type <span class="op">=</span> <span class="st">"regular"</span><span class="op">)</span></span></code></pre></div>
<p>This function uses two specific arguments:</p>
<ul>
<li>
<code>density</code>: the density of points to sample on the linear structure. (see <code><a href="https://r-spatial.github.io/sf/reference/st_line_sample.html" class="external-link">sf::st_line_sample()</a></code> for further detail)</li>
<li>
<code>type</code>: the method to sample points on the linear shape. Either <code>regular</code> (default) or <code>random</code>
</li>
</ul>
<p><br></p>
<p>The returned object has the same format as in <code><a href="../reference/distance_euclidean.html">distance_euclidean()</a></code>.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="edges-weights-vector">Edges weights vector<a class="anchor" aria-label="anchor" href="#edges-weights-vector"></a>
</h2>
<p>The second object (optional) required by AEM is the <strong>edges weights vector</strong>. It is a simple numeric vector giving the weight of each edge. Here we are going to use the Euclidean distance as the edge weight.</p>
<p><br></p>
<p>The function <code><a href="../reference/edges_weights_vector.html">edges_weights_vector()</a></code> of the package <code>bridge</code> takes the output of the function <code><a href="../reference/distance_euclidean.html">distance_euclidean()</a></code> (or <code><a href="../reference/distance_along.html">distance_along()</a></code>) to create this edges weights vector.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Edges weights vector ----</span></span>
<span><span class="va">adour_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edges_weights_vector.html">edges_weights_vector</a></span><span class="op">(</span><span class="va">adour_edges_mat</span>, <span class="va">adour_dists</span><span class="op">)</span></span>
<span><span class="va">adour_weights</span></span>
<span><span class="co">#&gt;       E-01       E-02       E-03       E-04       E-05       E-06       E-07 </span></span>
<span><span class="co">#&gt; 158037.200  12278.287  11735.397   9786.038  14567.619  18023.365  15572.540 </span></span>
<span><span class="co">#&gt;       E-08       E-09       E-10 </span></span>
<span><span class="co">#&gt;  14834.325  16477.810  39509.300</span></span></code></pre></div>
<p><br></p>
<p>Now we can run an AEM as follow: <code>adespatial::aem(adour_edges_mat, weight = adour_weights)</code></p>
<p><br></p>
<p><strong>Note:</strong> if you want to remove the first (fictitious) edge, you need to use the function as follow: <code>adespatial::aem(adour_edges_mat, weight = adour_weights[-1], rm.link0 = TRUE)</code></p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Bivand R. <em>et al.</em> (2022) spdep: Spatial dependence, weighting schemes, and statistics. R package version 1.2-4, <a href="https://CRAN.R-project.org/package=spdep" class="external-link">https://CRAN.R-project.org/package=spdep</a>.</p>
<p>Blanchet F. G., Legendre P. &amp; Borcard D. (2008) Modelling directional spatial processes in ecological data. <strong>Ecological Modelling</strong>, 215, 325-336. doi: <a href="https://doi.org/10.1016/j.ecolmodel.2008.04.001" class="external-link">10.1016/j.ecolmodel.2008.04.001</a>.</p>
<p>Dray S., Legendre P. &amp; Peres-Neto P. R. (2006) Spatial modelling: a comprehensive framework for principal coordinate analysis of neighbour matrices (PCNM). <strong>Ecological Modelling</strong>, 196, 483-493. doi: <a href="https://doi.org/10.1016/j.ecolmodel.2006.02.015" class="external-link">10.1016/j.ecolmodel.2006.02.015</a>.</p>
<p>Dray S. <em>et al.</em> (2022) adespatial: Multivariate Multiscale Spatial Analysis. R package version 0.3-16, <a href="https://CRAN.R-project.org/package=adespatial" class="external-link">https://CRAN.R-project.org/package=adespatial</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicolas Casajus.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
